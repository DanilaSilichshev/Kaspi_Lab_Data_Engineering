1) Почитайте про оконные функции. Как вы думаете, в чем отличие SUM() от SUM() OVER()? 
В чем отличие RANK от DENSE_RANK?
Оконная функция выполняет вычисления для набора строк, некоторым образом связанных с текущей строкой. 
Можно сравнить её с агрегатной функцией, но, в отличие от обычной агрегатной функции, при использовании 
оконной функции несколько строк не группируются в одну, а продолжают существовать отдельно. 
Внутри же, оконная функция, как и агрегатная, может обращаться не только к текущей строке результата запроса.
В результате группировки и применения агрегатной функции SUM() количество строк уменьшится, в то время SUM() OVER() 
напротив никак не влияет на количество строк в результате её применения.  OVER() в выражении SUM() OVER() означает, 
что окном для применения функции SUM() являются все строки.
Разница между функциями RANK() и DENSE_RANK() - это случаи, когда есть "связь"; то есть в случаях, 
когда несколько значений в наборе имеют одинаковое ранжирование. В таких случаях RANK() назначает непересекающиеся "ранги" 
значениям в наборе (что приводит к разрыву между значениями целочисленного ранжирования при наличии связи), тогда как 
DENSE_RANK() назначает последовательные ранги значениям в множестве (поэтому не будет пробелов между целыми значениями ранжирования в случае привязки). 
Например, рассмотрим множество {25, 25, 50, 75, 75, 100}. Для такого набора RANK() вернет {1, 1, 3, 4, 4, 6} 
(значения 2 и 5 пропущены), тогда как DENSE_RANK() вернет {1,1,2,3, 3,4}.
